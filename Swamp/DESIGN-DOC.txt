

Snekbox: Production Specifications Document


INDEX
	1.. Circuit design
	2.. Bill of materials
	3.. Physical interface
	4.. Firmware: Ophiuchus
	5.. Firmware: Serpentarium
	6.. Firmware: Swamp
	7.. Firmware: Planets
	8.. Firmware: Looper
	9.. Firmware: Burst
	10. Firmware: Generator
	11. Firmware: Harmonizer


Section 1: "Circuit design"

	The Swamp's circuit consists of:
		* An ATMEGA328P core;
		* MIDI I/O ports, with a 6N137 optoisolator on the MIDI-IN;
		* An 8x8 LED matrix, driven by a MAX7219;
		* A 4x8 button matrix, driven directly by the aforementioned ATMEGA328P;
		* An SD-card socket, with a 74HC4050 level-shifter;
		* A 9v DC barrel-jack, with both 5v and 3.3v regulators.

	TODO: make a schematic PNG, put it in the repo, and link it here


Section 2: "Bill of materials"

	TODO: write this


Section 3: "Physical interface"

	The layout of the interface is as follows:

	.--------------------------.
	| b b b b :::::::: b b b b |
	| b b b b :::::::: b b b b |
	| b b b b :::::::: b b b b |
	| b b b b :::::::: b b b b |
    '--------------------------'

	Key:
		: -- Two LEDs
		b -- Buttons


Section 4: "Firmware: Ophiuchus"

	TODO: write this


Section 5: "Firmware: Serpentarium"

	TODO: write this


Section 6: "Firmware: Marsh"

	.--------------------------.
	| a a a n :::::::: t t t t |
	| c c c c :::::::: f h p v |
	| o o o o :::::::: l r u d |
	| m m m m :::::::: m m m m |
    '--------------------------'

	Key:
		a - "lane": active lane number (binary notation, 0-7)
		n - "notes thru": toggles whether lane sends duplicate THRU-notes for its assigned channel
		c - "channel": lane's MIDI channel (binary notation, 0-15)
		o - "duration": duration of lane's notes (buttons: 6, 12, 24, 48; when unfilled, this means "1")
		t - "ticks": all notes will move one space for every "t" CLOCK ticks (buttons: 6, 12, 24, 48; when unfilled, this means "only when forced by new notes")
		f - "flush": flush all swamp-notes to the output
		h - "scramble chan": scramble all channels in the swamp with each other
		p - "scramble pitch": scramble all pitches in the swamp with each other
		v - "scramble velo": scramble all velocities in the swamp with each other
		l - "left": move all notes left
		r - "right": move all notes right
		u - "up": move all notes up
		d - "down": move all notes down
		m - "dam": push all of the column's notes rightward, and stop new notes from entering the column unless forced
			>> notes pushed off the right side by "m" are all sent to the output


Section 7: "Firmware: Planets"

	TODO: write this


Section 8: "Firmware: Looper"

	TODO: write this


Section 9: "Firmware: Burst"

	.--------------------------.
	| a a a s :::::::: c c c c |
	| p p p p :::::::: h h h h |
	| l l l l :::::::: m m m m |
	| b b b b :::::::: b b b b |
    '--------------------------'

	Key:
		a - Lane: active lane number (binary notation, 0-7)
		s - Save: save settings to EEPROM
		c - Channel: lane's MIDI channel (binary notation, 0-15)
		p - Spacing: CLOCK ticks between this lane's burst notes (buttons: 3, 6, 12, 24; when unfilled, this means "1")
		h - Chance: chance that a note in this lane will trigger a burst (binary notation, 0-15)
		l - Slope: the rate of change in velocity, within the notes of a given burst. (binary notation, 0-15; 0 = full left bias; 15 = full right bias)
		m - Humanize: the rate of random change in velocity, per note (binary notation, 0-15; 0 = no change; 15 = fully random)
		b - Burst: trigger a burst in the corresponding lane that lasts until the button is released

	TODO: change this if the programming work goes in a different direction


Section 10: "Firmware: Generator"

	.--------------------------.
	| d d d d :::::::: s l g p |
	| o o o o :::::::: c c c c |
	| a a a a :::::::: a a a a |
	| k k k k :::::::: r r r r |
    '--------------------------'

	Key:
		d - Density
		s - Shift secondary values
			>> s+(l/g): Internal BPM down/up (only applies when in SELF-GENERATE mode)
			>> s+d: Density variation
			>> s+o: Octave variation
			>> s+c: Channel variation
			>> s+a: Scale variation
			>> s+k: K-species variation
			>> s+r: Rotation variation
		l - MIDI LEARN: when held down, learn which channel to respond to when in SELF-GENERATE mode (variable saved to EEPROM every time)
		g - Toggle whether to self-generate, or respond only to other notes (Also toggles MIDI HEAD / MIDI TAIL)
		p - PLAY: Begin playing a sequence (only applies when in SELF-GENERATE mode)
		o - Octave (0-11)
		c - MIDI channel (0-15)
		a - Scale number (arranged by consonance)
		k - K-species (number of active notes in scale)
		r - Rotation (base rotation organized by largest interval)

	TODO: change this if the programming work goes in a different direction


Section 11: "Firmware: Harmonizer"

	TODO: write this

