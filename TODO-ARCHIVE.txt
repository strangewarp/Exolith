

Tine TODO-ARCHIVE (to keep a record of already-finished tasks)

Software:

	. figure out why the savefile system defaults to file "04"
		-- loadPrefs() was missing a makePrefBuf() call, inside its "if (!sd.exists(pn)) ..." clause
		. check whether this fixes things
			-- seems to have fixed it

	-- found a UI bug: copyCmd had the wrong numerical value in KEYTAB[]

	. check whether there's an additional "MIDI Tempo" SYSEX command, or whether it's solely dictated by TEMPO TICK events
		-- yeah but it's a 4-byte SYSEX command. so...
		. change all sequencing mechanisms in the following ways:
			-- am doing
			. BPM command is now a 2-byte command, in the format of "240 x 0":
				. "x": the BPM value (bounded to 16-200)
					-- ok
			. change note-entry system to allow BPM commands to be entered
				-- done
			. when a BPM command is encountered by the sequencing mechanism, only change the internal BPM value; do not actually send anything to MIDI-OUT
				-- done
			. anything that checks for 2-byte or 3-byte commands, or command-type in general, needs to be double-checked for conflicts with the BPM command type
				-- ok

	-- also moved the MOUT_COUNT checking mechanism into parseTickContents(), since every BPM-CHANGE needs to be caught, regardless of how full MOUT_COUNT gets.
		-- this hypothetically slightly reduces performance, could revert it later if I need to

	-- updated chanCmd() to compensate correctly for the validity of command-values of 240
	-- updated upperBitsCmd() similarly

	. make the BPM command accessible through both PLAY MODE and RECORD MODE, with the same control-button chord
	.     (this is especially necessary so the user can compensate for blunders related to slicing into a bad BPM during a performance)
		-- am doing
		-- chord number: 010001 (in-code: 100010)
		. update button-key.txt
			-- done
		. change BPM's behavior in assignKey() et al
			-- am doing
			. for PLAY MODE
				-- done
		. change BPM's key-chord in RECORD MODE
			-- done
			. change command-lists in data_cmds.ino
				-- done
		. add a "BPM" indicator to the GUI for PLAY MODE
			-- done
		. change the "BPM" case in the GUI for RECORD MODE
			-- done
		. remove "todo update" entries from button-key.txt
			-- done

	. add "BPM" glyph to PLAY MODE's BPM command
		-- am doing
		. update TO_UPDATE flags in unassignKey() and parsePlayPress() to cover the bottom 6 rows as well
			-- done
		. update GUI parser in updatePlayBottomRows() to display the BPM-glyph when a BPM chord is held
			-- done

	-- fixed a one-off error for the "col" value in the call to tempoCmd() from parsePlayPress()
	-- fixed the manner in which updatePlayBottomRows() displays the TEMPO glyph when PLAY MODE's BPM command is held
	-- made the BPM sigil appear in PLAY MODE at all the correct times

	. unknown command-types in RECORD MODE need to set a TO_UPDATE flag for the bottom 6 rows (currently seems to only flag top row)
		-- fixed: it was a mismatched value in the KEYTAB array

	-- found and (probably) fixed a bug where all sequenced notes were acting like they had a duration of 0
	-- changed writeCommands() to correctly overwrite BPM-change commands
	-- fixed the ERASE WHILE HELD glyph to change its appearance depending on whether note-recording is active

	-- updated the MIDI-IN system to only call file.sync() once per tick max, to save on SD-card wear (still requires testing)
	-- increased the length of the BLINK that occurs on each QUANTIZE tick in RECORD MODE

	. change REPEAT so that held chords are recorded into TRACK 1 & 2 simultaneously
		-- done
	. in RECORD MODE, BLINK should only illuminate the half of the screen that corresponds to the current TRACK
		-- done

	-- made recording-blinks longer in RECORD-MODE
		-- tweaked the duration for this again

	. redesign the top LED-row in RECORD MODE:
		-- am doing
		. the quantize-tick should only be displayed in LEDs 5 and 6
			-- done
		. the currently-active TRACK should be displayed in LEDs 7 and 8
			-- done

Hardware:


